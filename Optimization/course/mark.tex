\chapter{Поиск оптимальной стратегии принятия решений с использованием марковских моделей}
\section{Постановка задачи}
\textbf{Вариант:} 12, решить задачу методом итераций по стратегиям для $N=\infty$\\\\
%\textbf{Примечание:} задание из книги Г. Вагнера «Основы исследования операций», т. 3, стр. 183 – 184
Крупная фирма, производящая моющие средства и пользующаяся широкой известностью в связи с успехами в исследованиях по созданию новых продуктов и их рекламированию, выпустила на рынок новый высококачественный стиральный порошок, названный LYE. Руководитель, возглавляющий производство этого продукта, совместно с отделом рекламы разрабатывает специальную рекламную кампанию по сбыту порошка, для которой принят девиз «Порошок LYE нужен всем!» Как и все продукты фирмы, новый продукт в течение первого полугодия будет иметь высокий уровень сбыта. Руководитель полагает, что с вероятностью 0,8 этот уровень сбыта сохранится и в последующем полугодии при условии проведения особой рекламной кампании и что эта вероятность составит всего 0,5, если такую кампанию не проводить. В случае, если уровень сбыта снизится до среднего, у руководителя имеются две возможности. Он может дать указание о проведении исследований с целью улучшения качества продукта. При этом условии с вероятностью 0,7 уровень сбыта к началу следующего полугодия повысится до первоначального высокого значения. С другой стороны, можно ничего не предпринимать в отношении улучшения качества продукта. Тогда с вероятностью 0,6 в начале последующего полугодия уровень сбыта останется средним, однако вследствие изменений потребительских вкусов он может вновь подняться до высокого значения лишь с вероятностью 0,4.

Если сбыт нового стирального порошка начинается на высоком уровне при обычной рекламе, то прибыли в течение полугодия равны 19 единицам в случае, когда этот уровень сохраняется, и равны 13, если уровень сбыта падает. При проведении специальной рекламной кампании соответствующие показатели равны 4,5 и 2 единицам. Если начальный уровень сбыта окажется средним и при этом проводятся исследования с целью улучшения качества продукции, то прибыли составят 11 единиц в случае, когда уровень сбыта поднимается до высокого, и 9 единиц в противном случае. При сохранении продукта в неизменном виде соответствующие прибыли равны 13 и 3 единицам. Предположим, что одна и та же проблема принятия решений относительно сбыта стирального порошка LYE повторяется через каждые полгода в течение бесконечного планового периода.


\section{Метод итераций по стратегиям}
Для начала выпишем все известные параметры задачи. 

Система может быть в двух состояних:
\begin{enumerate}
\item хороший сбыт($S_1$);
\item средний сбыт($S_2$).
\end{enumerate}  
Организация может предпринять следующие действия(далее стратегии):
\begin{enumerate}
\item всегда улучшать сбыт($X_1$)
\begin{itemize}
\item при $S_1$ - создание специальной рекламы($D_1$);
\item при $S_2$ - проведение исследований($D_2$). 
\end{itemize}
\item улучшать сбыт только при хорошем сбыте($X_2$)
\begin{itemize}
\item при $S_1$ - создание специальной рекламы($D_1$);
\item при $S_2$ - ничего не делать($D_3$). 
\end{itemize}
\item улучшать сбыт только при среднем сбыте($X_3$)
\begin{itemize}
\item при $S_1$ - ничего не делать($D_3$);
\item при $S_2$ - проведение исследований($D_2$). 
\end{itemize}
\item всегда ничего не делать($X_4$)
\begin{itemize}
\item при $S_1$ - ничего не делать($D_3$);
\item при $S_2$ - ничего не делать($D_3$). 
\end{itemize}
\end{enumerate}

На основе данной информации составим матрицы переходных вероятностей $P_1, P_2, P_3, P_4$ соответсвующие стратегиям $X_1, X_2, X_3, X_4$.

\begin{equation*}
P_1=\begin{pmatrix}
0.8 & 0.2\\
0.7 & 0.3
\end{pmatrix}\\
P_2=\begin{pmatrix}
0.8 & 0.2\\
0.4 & 0.6
\end{pmatrix}\\
P_3=\begin{pmatrix}
0.5 & 0.5\\
0.7 & 0.3
\end{pmatrix}\\
P_4=\begin{pmatrix}
0.5 & 0.5\\
0.4 & 0.6
\end{pmatrix}
\end{equation*}
%Строки означают попытки улучшить сбыт. Первая строка - специальная реклама, а вторая - улучшение качества продукта.
%
%Столбцы означают состояние сбытая. Первый столбец - хороший сбыт, второй - средний сбыт.
%
%То есть, если провести специальную рекламу, система с вероятностью в 0.8 останется в состоянии хорошого сбыта, и с верояностью в 0.2 перейдет в состояние среднего сбыта. По аналогии при улучшении качества продукта.
%
%Составим матрицу переходных вероятностей, если не предпринимать никаких действий.

%Если сравнивать $P_1$ и $P_2$, то у $P_1$ вероятность того что система будет в состоянии хорошего сбыта, выше чем у $P_2$.

Также составим матрицы доходов $R_1, R_2, R_3, R_4$.
\begin{equation*}
R_1=\begin{pmatrix}
4.5 & 2\\
11 & 9
\end{pmatrix}\\
R_2=\begin{pmatrix}
4.5 & 2\\
13 & 3
\end{pmatrix}\\
R_3=\begin{pmatrix}
19 & 13\\
11 & 9
\end{pmatrix}\\
R_4=\begin{pmatrix}
19 & 13\\
13 & 3
\end{pmatrix}
\end{equation*}
Множество допустимых стратегий $G=\{X_1, X_2, X_3, X_4\}$.
\subsection{Этап(1) оценивания параметров}
Выбираем стратегию $\tau$ - $X_4$.  Тогда, матрицы переходных вероятностей и доходов будут следующими:
\begin{equation*}
P=\begin{pmatrix}
0.5 & 0.5\\
0.4 & 0.6
\end{pmatrix}\\
R=\begin{pmatrix}
19 & 13\\
13 & 3
\end{pmatrix}
\end{equation*}
Учитывая, что  $F_{\tau}(2)=0$, получаем систему линейных алгебраических уравнений:

\begin{equation*}
\begin{cases}
E_{\tau}-(1-0.5)*F_{\tau}(1)=16\\
E_{\tau}-(1-0.4)*F_{\tau}(1)=7
\end{cases}
\end{equation*}
\begin{lstlisting}[language={matlab}, caption={Скрпит для решения системы уравнений},basicstyle=\ttfamily]
syms Et Ft
eqn1 = Et - (1-0.5)*Ft == 16;
eqn2 = Et - (1-0.4)*Ft == 7;
[A, B] = equationsToMatrix([eqn1, eqn2], [Et, Ft])
X = linsolve(A, B)
\end{lstlisting}
В результате выполнения скрипта matlab, было получено единственное решение:
\begin{equation*}
E_{\tau}=61; F_{\tau}(1)=90
\end{equation*}

\subsection{Этап(1) улучшения стратегии}
Для каждого состояния $S_j$, где $j$ от $1$ до $m$, найдем допустимое решение, на котором достигается:
\begin{equation*}
max(v_j(X_i)+\sum_{k=1}^mp_{jk}(X_i)F_{\tau}(k)
\end{equation*}


\tabulinesep = 1mm
\begin{longtabu} to \textwidth {|X[1, c , m ] |X[3, c , m ] | X[3,c , m ]|X[3,c , m ]|X[3,c , m ]| X[2,c , m ]|X[1,c , m ]|}\firsthline\hline

\multirow{2}{*}{$S_j$} & \multicolumn{4}{c|}{$\varphi_i=v_j(X_i)+p_{j1}(X_i)F_i(1)$} & \multirow{2}{*}{$max\varphi_i$} & \multirow{2}{*}{$X_{j}$}\\ \cline{2-5}
&i=1&i=2&i=3&i=4&&\\ \hline
1&4+0.8*(90)= 76&4+0.8*(90)= 76&16+0.5*(90)= 61&16+0.5*(90)= 61&76&$X_1$, $X_2$\\ \hline
2&10.4+0.7*(90)= 73.4&7+0.4*(90)= 40&10.4+0.7*(90)= 73.4&7+0.4*(90)= 40&73.4&$X_1$, $X_3$\\ \hline
\end{longtabu}


\subsection{Этап(2) оценивания параметров}
Выбираем стратегию $\tau$ - $X_3$.  Тогда, матрицы переходных вероятностей и доходов будут следующими:
\begin{equation*}
P=\begin{pmatrix}
0.5 & 0.5\\
0.7 & 0.3
\end{pmatrix}\\
R=\begin{pmatrix}
19 & 13\\
11 & 9
\end{pmatrix}
\end{equation*}
Учитывая, что  $F_{\tau}(2)=0$, получаем систему линейных алгебраических уравнений:

\begin{equation*}
\begin{cases}
E_{\tau}-(1-0.5)*F_{\tau}(1)=16\\
E_{\tau}-(1-0.7)*F_{\tau}(1)=10.4
\end{cases}
\end{equation*}
\begin{lstlisting}[language={matlab}, caption={Скрпит для решения системы уравнений},basicstyle=\ttfamily]
syms Et Ft
eqn1 = Et - (1-0.5)*Ft == 16;
eqn2 = Et - (1-0.7)*Ft == 10.4;
[A, B] = equationsToMatrix([eqn1, eqn2], [Et, Ft])
X = linsolve(A, B)
\end{lstlisting}
В результате выполнения скрипта matlab, было получено единственное решение:
\begin{equation*}
E_{\tau}=2; F_{\tau}(1)=-28
\end{equation*}

\subsection{Этап(2) улучшения стратегии}
Для каждого состояния $S_j$, где $j$ от $1$ до $m$, найдем допустимое решение, на котором достигается:
\begin{equation*}
max(v_j(X_i)+\sum_{k=1}^mp_{jk}(X_i)F_{\tau}(k)
\end{equation*}


\tabulinesep = 1mm
\begin{longtabu} to \textwidth {|X[1, c , m ] |X[3, c , m ] | X[3,c , m ]|X[3,c , m ]|X[3,c , m ]| X[2,c , m ]|X[1,c , m ]|}\firsthline\hline

\multirow{2}{*}{$S_j$} & \multicolumn{4}{c|}{$\varphi_i=v_j(X_i)+p_{j1}(X_i)F_i(1)$} & \multirow{2}{*}{$max\varphi_i$} & \multirow{2}{*}{$X_{j}$}\\ \cline{2-5}
&i=1&i=2&i=3&i=4&&\\ \hline
1&4+0.8*(-28)= -18.4&4+0.8*(-28)= -18.4&16+0.5*(-28)= 2&16+0.5*(-28)= 2&2&$X_3$, $X_4$\\ \hline
2&10.4+0.7*(-28)= -9.2&7+0.4*(-28)= -4.2&10.4+0.7*(-28)= -9.2&7+0.4*(-28)= -4.2&-4.2&$X_2$, $X_4$\\ \hline
\end{longtabu}

Так как $t\neq\tau$, то снова переходим к этапу оценивания параметров.


\subsection{Этап(3) оценивания параметров}
Выбираем стратегию $\tau$ - $X_2$.  Тогда, матрицы переходных вероятностей и доходов будут следующими:
\begin{equation*}
P=\begin{pmatrix}
0.8 & 0.2\\
0.4 & 0.6
\end{pmatrix}\\
R=\begin{pmatrix}
4.5 & 2\\
13 & 3
\end{pmatrix}
\end{equation*}
Учитывая, что  $F_{\tau}(2)=0$, получаем систему линейных алгебраических уравнений:

\begin{equation*}
\begin{cases}
E_{\tau}-(1-0.8)*F_{\tau}(1)=4\\
E_{\tau}-(1-0.4)*F_{\tau}(1)=7
\end{cases}
\end{equation*}
\begin{lstlisting}[language={matlab}, caption={Скрпит для решения системы уравнений}, basicstyle=\ttfamily]
syms Et Ft
eqn1 = Et - (1-0.8)*Ft == 4;
eqn2 = Et - (1-0.4)*Ft == 7;
[A, B] = equationsToMatrix([eqn1, eqn2], [Et, Ft])
X = linsolve(A, B)
\end{lstlisting}
В результате выполнения скрипта matlab, было получено единственное решение:
\begin{equation*}
E_{\tau}=5/2; F_{\tau}(1)=-15/2
\end{equation*}


\subsection{Этап(3) улучшения стратегии}
Для каждого состояния $S_j$, где $j$ от $1$ до $m$, найдем допустимое решение, на котором достигается:
\begin{equation*}
max(v_j(X_i)+\sum_{k=1}^mp_{jk}(X_i)F_{\tau}(k)
\end{equation*}


\tabulinesep = 1mm
\begin{longtabu} to \textwidth {|X[1, c , m ] |X[3, c , m ] | X[3,c , m ]|X[3,c , m ]|X[3,c , m ]| X[2,c , m ]|X[1,c , m ]|}\firsthline\hline

\multirow{2}{*}{$S_j$} & \multicolumn{4}{c|}{$\varphi_i=v_j(X_i)+p_{j1}(X_i)F_i(1)$} & \multirow{2}{*}{$max\varphi_i$} & \multirow{2}{*}{$X_{j}$}\\ \cline{2-5}
&i=1&i=2&i=3&i=4&&\\ \hline
1&4+0.8*(-15/2)= -2&4+0.8*(-15/2)= -2&16+0.5*(-15/2)= 12.25&16+0.5*(-15/2)= 12.25&12.25&$X_3$, $X_4$\\ \hline
2&10.4+0.7*(-15/2)= 5.15&7+0.4*(-15/2)= 4&10.4+0.7*(-15/2)= 5.15&7+0.4*(-15/2)= 4&5.15&$X_1$, $X_3$\\ \hline
\end{longtabu}

Так как $t\neq\tau$, то снова переходим к этапу оценивания параметров.


\subsection{Этап(4) оценивания параметров}
Выбираем стратегию $\tau$ - $X_1$.  Тогда, матрицы переходных вероятностей и доходов будут следующими:
\begin{equation*}
P=\begin{pmatrix}
0.8 & 0.2\\
0.7 & 0.3
\end{pmatrix}\\
R=\begin{pmatrix}
4.5 & 2\\
11 & 9
\end{pmatrix}
\end{equation*}
Учитывая, что  $F_{\tau}(2)=0$, получаем систему линейных алгебраических уравнений:

\begin{equation*}
\begin{cases}
E_{\tau}-(1-0.8)*F_{\tau}(1)=4\\
E_{\tau}-(1-0.7)*F_{\tau}(1)=10.4
\end{cases}
\end{equation*}
\begin{lstlisting}[language={matlab}, caption={Скрпит для решения системы уравнений}, basicstyle=\ttfamily]
syms Et Ft
eqn1 = Et - (1-0.8)*Ft == 4;
eqn2 = Et - (1-0.7)*Ft == 10.4;
[A, B] = equationsToMatrix([eqn1, eqn2], [Et, Ft])
X = linsolve(A, B)
\end{lstlisting}
В результате выполнения скрипта matlab, было получено единственное решение:
\begin{equation*}
E_{\tau}=-44/5; F_{\tau}(1)=-64
\end{equation*}

\subsection{Этап(4) улучшения стратегии}
Для каждого состояния $S_j$, где $j$ от $1$ до $m$, найдем допустимое решение, на котором достигается:
\begin{equation*}
max(v_j(X_i)+\sum_{k=1}^mp_{jk}(X_i)F_{\tau}(k)
\end{equation*}


\tabulinesep = 1mm
\begin{longtabu} to \textwidth {|X[1, c , m ] |X[3, c , m ] | X[3,c , m ]|X[3,c , m ]|X[3,c , m ]| X[2,c , m ]|X[1,c , m ]|}\firsthline\hline

\multirow{2}{*}{$S_j$} & \multicolumn{4}{c|}{$\varphi_i=v_j(X_i)+p_{j1}(X_i)F_i(1)$} & \multirow{2}{*}{$max\varphi_i$} & \multirow{2}{*}{$X_{j}$}\\ \cline{2-5}
&i=1&i=2&i=3&i=4&&\\ \hline
1&4+0.8*(-64)= -47.2&4+0.8*(-64)= -47.2&16+0.5*(-64)= -16&16+0.5*(-64)= -16&-16&$X_3$, $X_4$\\ \hline
2&10.4+0.7*(-64)= -34.4&7+0.4*(-64)= -18.6&10.4+0.7*(-64)= -34.4&7+0.4*(-64)= -18.6&-18.6&$X_2$, $X_4$\\ \hline
\end{longtabu}

Итак в этапе(2) и данном, были найдены оптимальные стратегии. То есть

\begin{equation*}
\tau=((X_3 \textit{ или } X_4), (X_2 \textit{ или } X_4))^T
\end{equation*}
В каждом из двух состояний, имеется два варианта дальнейших действий.

Если подвести итоги, то данное решение означает что:
\begin{itemize}
\item В состоянии хорошего сбыта($S_1$) - ничего не делать($D_3$);
\item В состоянии среднего сбыта($S_2$) - ничего не делать($D_3$).
\end{itemize}
И судя по данным итогам, ничего не делать($D_3$) является лучшей стратегией. Подобный исход можно объяснить тем, что при попытках увеличения сбыта, компания тратит на это деньги и соответственно доход снижается.


